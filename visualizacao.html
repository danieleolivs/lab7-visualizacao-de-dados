<!--
	THIS EXAMPLE WAS DOWNLOADED FROM https://echarts.apache.org/examples/en/editor.html?c=candlestick-sh-2015
-->
<!DOCTYPE html>
<html lang="en" style="height: 100%">
<head>
  <meta charset="utf-8">
    <style>
        body {
        height: 100%;
        margin: 0;
        display: flex;
        flex-direction: column; 
        }
        #mapa {
            height: 70%; 
        }
        #container {
            height: 30%; 
        }
    </style>
</head>
<body style="height: 100%; margin: 0">
    <div id="mapa" style="height: 100%"></div>
    <div id="container" style="height: 100%"></div>
  
  
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
  
  <!-- Uncomment this line if you want to dataTool extension
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5/dist/extension/dataTool.min.js"></script>
  -->
  <!-- Uncomment this line if you want to use gl extension
  <script type="text/javascript" src="https://echarts.apache.org/en/js/vendors/echarts-gl/dist/echarts-gl.min.js"></script>
  -->
  <!-- Uncomment this line if you want to echarts-stat extension
  <script type="text/javascript" src="https://echarts.apache.org/en/js/vendors/echarts-stat/dist/ecStat.min.js"></script>
  -->
  <!-- Uncomment this line if you want to echarts-graph-modularity extension
  <script type="text/javascript" src="https://echarts.apache.org/en/js/vendors/echarts-graph-modularity/dist/echarts-graph-modularity.min.js"></script>
  -->
  <!-- Uncomment this line if you want to use map
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@4.9.0/map/js/world.js"></script>
  -->
  <!-- Uncomment these two lines if you want to use bmap extension
  <script type="text/javascript" src="https://api.map.baidu.com/api?v=3.0&ak=YOUR_API_KEY"></script>
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5/dist/extension/bmap.min.js"></script>
  -->

  <script type="text/javascript">
    const dom = document.getElementById('container');
    const myChart = echarts.init(dom);

    const chartMapa = echarts.init(document.getElementById('mapa'));

    fetch('BR-exportacoes_importacoes_2025.json')
    .then(res => res.json())
    .then(data => {
      const anos = Object.keys(data.BAL).sort(); 
      
     
      const exportacoes = anos.map(ano => {
        return data.EXP[ano].reduce((sum, item) => sum + item.us_value, 0);
      });
      const importacoes = anos.map(ano => {
        return data.IMP[ano].reduce((sum, item) => sum + item.us_value, 0);
      });
      const balancos = anos.map(ano => {
        return data.BAL[ano].reduce((sum, item) => sum + item.us_value, 0);
      });

      const option = {
        grid: {
          left: '10%',
          right: '10%',
          bottom: '23%',
          containLabel: true
        },
        xAxis: {
          type: 'category',
          data: anos,
          name:'Série histórica',
          nameLocation: 'middle',
          nameGap: 30
        },
       yAxis: {
          type: 'value',
          name:'Bilhoes de US$',
          axisLabel: {
            formatter: function (value) {
              const num = Number(value) / 1e9;
              return num % 1 === 0
                ? num.toString()
                : num.toFixed(2).replace(/\.?0+$/, '');
            }
          },
        },
        dataZoom: [
          {
            textStyle: {
              color: '#8392A5'
            },
            handleIcon:
              'path://M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4v1.3h1.3v-1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7V23h6.6V24.4z M13.3,19.6H6.7v-1.4h6.6V19.6z',
            dataBackground: {
              areaStyle: {
                color: '#8392A5'
              },
              lineStyle: {
                opacity: 0.8,
                color: '#8392A5'
              }
            },
            brushSelect: true
          },
          {
            type: 'inside'
          }
        ],
        title: {
            text: 'Total por ano',
            left:115,
            textStyle: {
                fontSize: 14,
                fontWeight: 'bold',
                color: '#333'
            },
        },
        tooltip: { trigger: 'axis' },
        legend: { data: ['Exportação', 'Importação', 'Balança Comercial'] },
        series: [
          {
            name: 'Exportação',
            type: 'line',
            smooth: true,
            data: exportacoes,
            lineStyle:{
              color:"#3b908c"
            },
            itemStyle:{
              color:"#3b908c"
            }
          },
          {
            name: 'Importação',
            type: 'line',
            smooth: true,
            data: importacoes,
            lineStyle:{
              color:"#e06174"
            },
            itemStyle:{
              color:"#e06174"
            }
          },
          {
            name: 'Balança Comercial',
            type: 'line',
            smooth: true,
            data: balancos,
            lineStyle:{
              type: 'dashed',
              color:"#b1bdf5"
            },
            itemStyle:{
              color:"#b1bdf5"
            }
          }
        ]
      };

      myChart.setOption(option);

    })
    .catch(console.error);


    window.addEventListener('resize', () => {
      chartLinha.resize();
      chartMapa.resize();
    });
  </script>
</body>
</html>